@model SistemasAnaliticos.Entidades.Usuario

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">

    <style>
        .bg-gradient-custom {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        }

        :root {
            --primary-color: #012473;
            --secondary-color: #013599;
            --danger-color: #E00319;
            --success-color: #198754;
        }

        .badge-department {
            background-color: #e3f2fd;
            color: #0d6efd;
            border: 1px solid #bbdefb;
        }

        .badge-active {
            background-color: #d1e7dd;
            color: #0f5132;
        }

        .badge-inactive {
            background-color: #e7d1d1;
            color: #c74854;
        }

        .avatar-large {
            width: 160px;
            height: 160px;
            border-radius: 40%;
            object-fit: cover;
            border: 4px solid var(--primary-color);
            cursor: pointer;
            transition: transform 0.3s ease;
        }

            .avatar-large:hover {
                transform: scale(1.05);
            }

        .employee-id {
            color: var(--primary-color);
            font-weight: bold;
        }

        .info-icon {
            color: var(--primary-color);
        }

        .card-title-custom {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Modal para imagen ampliada */
        .modal-image {
            max-width: 100%;
            max-height: 80vh;
            border-radius: 8px;
        }
    </style>
</head>
<body class="bg-gradient-custom min-vh-100">

    <!-- Main Content -->
    <main class="container-xxl px-4 px-sm-6 px-lg-8 py-4">
        @if (Model == null)
        {
            <!-- Employee Not Found -->
            <div class="d-flex align-items-center justify-content-center" style="min-height: 68vh !important;">
                <div class="card shadow-sm border-0" style="max-width: 700px">
                    <div class="card-body p-5 pt-2 pb-0 text-center" style="display: flex; justify-content: center;">
                        <div class="flex-shrink-0">
                            <div id="lottie-animation" style="width: 240px; height: 240px;"></div>
                        </div>
                        <div style="display: flex; flex-wrap: wrap; align-content: center;">
                            <h2 class="h3 fw-bold text-dark mb-3 mt-3">Empleado no encontrado</h2>
                            <p class="text-muted mb-4">El empleado que buscas no existe en nuestro sistema.</p>
                        </div>
                    </div>
                    <div style="gap: 9%; padding-bottom: 4%; display: flex; justify-content: center; align-items: center;">
                        <a asp-controller="Usuario" asp-action="Index" class="btn btn-outline-secondary">
                            <i class="fas fa-arrow-left me-2"></i>
                            Volver a Empleados
                        </a>
                    </div>
                </div>
            </div>

            <script>
                // Inicializar la animación
                const animation = document.createElement('lottie-player');
                animation.setAttribute('src', '/lottie/Empty Box.json'); // Ruta a tu JSON
                animation.setAttribute('background', 'transparent');
                animation.setAttribute('speed', '1');
                animation.setAttribute('style', 'width: 240px; height: 240px;');
                animation.setAttribute('loop', '');
                animation.setAttribute('autoplay', '');

                document.getElementById('lottie-animation').appendChild(animation);
            </script>
        }
        else
        {
            <!-- Back Button -->
            <div class="mb-4">
                <a asp-controller="Usuario" asp-action="Index" class="btn btn-outline-secondary">
                    <i class="bi bi-arrow-left me-2"></i>
                    Volver a Empleados
                </a>
            </div>

            <!-- Employee Header Card -->
            <div class="card mb-4 shadow-sm">
                <div class="card-body p-4">
                    <div class="row g-4 align-items-start">
                        <!-- Large Avatar -->
                        <div class="col-md-auto text-center">
                            <div id="employeeAvatarContainer">
                                <img src="data:image/jpeg;base64,@Convert.ToBase64String(Model.foto)"
                                     class="avatar-large mb-3"
                                     alt="Foto del empleado"
                                     data-bs-toggle="modal"
                                     data-bs-target="#imageModal">
                            </div>
                        </div>

                        <!-- Employee Info -->
                        <div class="col-md">
                            <div class="d-flex flex-column flex-md-row justify-content-between mb-4">
                                <div class="mb-3 mb-md-0">
                                    <h1 class="display-6 fw-bold text-dark mb-2">@Model.nombreCompleto</h1>
                                    <p class="fs-5 text-muted mb-3">@Model.puesto</p>
                                    <div class="d-flex flex-wrap gap-2">
                                        <span class="badge badge-department">Depart. @Model.departamento</span>
                                        <span class="badge @(Model.estado ? "badge-active" : "badge-inactive")">
                                            @(Model.estado ? "Activo" : "Inactivo")
                                        </span>
                                    </div>
                                </div>
                                <div class="text-md-end">
                                    <p class="text-muted mb-1">Número de Empleado</p>
                                    <p class="fs-3 fw-bold employee-id">#@Model.noEmpleado</p>
                                </div>
                            </div>

                            <!-- Quick Contact Info -->
                            <div class="row g-3 mt-3">
                                <div class="col-md-4">
                                    <div class="d-flex align-items-center">
                                        <i class="bi bi-envelope info-icon me-3 fs-5"></i>
                                        <div class="flex-grow-1 min-width-0">
                                            <p class="text-muted mb-0 small">Correo Empresarial</p>
                                            <p class="fw-medium mb-0 text-break">@Model.correoEmpresa</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="d-flex align-items-center">
                                        <i class="bi bi-telephone info-icon me-3 fs-5"></i>
                                        <div class="flex-grow-1 min-width-0">
                                            <p class="text-muted mb-0 small">Teléfono Empresarial</p>
                                            <p class="fw-medium mb-0 text-break">+506 @Model.celularOficina</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="d-flex align-items-center">
                                        <i class="bi bi-person-bounding-box info-icon me-3 fs-5"></i>
                                        <div class="flex-grow-1 min-width-0">
                                            <p class="text-muted mb-0 small">Jefe</p>
                                            <p class="fw-medium mb-0 text-break @(Model.jefe == null ? "text-decoration-line-through text-danger" : "")">
                                                @(Model.jefe ?? "N/A")
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="d-flex align-items-center">
                                        <i class="bi bi-envelope info-icon me-3 fs-5"></i>
                                        <div class="flex-grow-1 min-width-0">
                                            <p class="text-muted mb-0 small">Correo Personal</p>
                                            <p class="fw-medium mb-0 text-break">@Model.correoPersonal</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="d-flex align-items-center">
                                        <i class="bi bi-telephone info-icon me-3 fs-5"></i>
                                        <div class="flex-grow-1 min-width-0">
                                            <p class="text-muted mb-0 small">Teléfono Personal</p>
                                            <p class="fw-medium mb-0 text-break">+506 @Model.celularPersonal</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <div class="d-flex align-items-center">
                                        <i class="bi bi-telephone-plus info-icon me-3 fs-5"></i>
                                        <div class="flex-grow-1 min-width-0">
                                            <p class="text-muted mb-0 small">Extensión</p>
                                            <p class="fw-medium mb-0 text-break @(Model.extension == null ? "text-decoration-line-through text-danger" : "")">
                                                @(Model.extension ?? "N/A")
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="d-flex align-items-center">
                                        <i class="bi bi-house-door info-icon me-3 fs-5"></i>
                                        <div class="flex-grow-1 min-width-0">
                                            <p class="text-muted mb-0 small">Número de Habitación</p>
                                            <p class="fw-medium mb-0 text-break @(Model.telefonoHabitacion == null ? "text-decoration-line-through text-danger" : "")">
                                                @(Model.telefonoHabitacion ?? "N/A")
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Detailed Information Grid -->
            <div class="row g-4">
                <!-- Personal Information -->
                <div class="col-lg-6">
                    <div class="card h-100 shadow-sm">
                        <div class="card-header bg-white">
                            <h5 class="card-title mb-0 card-title-custom">
                                <i class="bi bi-person-fill info-icon"></i>
                                Información Personal
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <!-- Columna izquierda -->
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <p class="text-muted mb-1 small">Número de Cédula</p>
                                        <p class="fw-medium">@Model.cedula</p>
                                    </div>
                                    <div class="mb-3">
                                        <p class="text-muted mb-1 small">Género</p>
                                        <p class="fw-medium">@Model.genero</p>
                                    </div>
                                    <div class="mb-3">
                                        <p class="text-muted mb-1 small">Hijos</p>
                                        <div style="display: flex; justify-content: space-between;">
                                            <P class="fw-medium @(Model.hijos)">
                                                @(Model.hijos ? "Si" : "No")
                                            </P>
                                            @if (Model.hijos == true)
                                            {
                                                <p class="fw-medium pe-5">Cantidad: @Model.cantidadHijos</p>
                                            }
                                        </div>
                                    </div>
                                </div>

                                <!-- Columna media -->
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <p class="text-muted mb-1 small">Fecha de Nacimiento</p>
                                        <p class="fw-medium">@string.Format("{0:dd-MM-yyyy}", Model.fechaNacimiento)</p>
                                    </div>
                                    <div class="mb-3">
                                        <p class="text-muted mb-1 small">Estado Civil</p>
                                        <p class="fw-medium">@Model.estadoCivil</p>
                                    </div>
                                    <div class="mb-3">
                                        <p class="text-muted mb-1 small">Licencia</p>
                                        <p class="fw-medium">@Model.licencias</p>
                                    </div>
                                </div>

                                <!-- Columna Derecha -->
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <p class="text-muted mb-1 small">Edad</p>
                                        <p class="fw-medium">@Model.edad años</p>
                                    </div>
                                    <div class="mb-3">
                                        <p class="text-muted mb-1 small">Tipo de Sangre</p>
                                        <p class="fw-medium">@Model.tipoSangre</p>
                                    </div>
                                    <div class="mb-3 flex-grow-1 min-width-0">
                                        <p class="text-muted mb-1 small">Padecimientos</p>
                                        <p class="fw-medium mb-0 text-break @(Model.padecimientosAlergias == null ? "text-decoration-line-through text-danger" : "")">
                                            @(Model.padecimientosAlergias ?? "N/A")
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Employment Information -->
                <div class="col-lg-6">
                    <div class="card h-100 shadow-sm">
                        <div class="card-header bg-white">
                            <h5 class="card-title mb-0 card-title-custom">
                                <i class="bi bi-buildings-fill info-icon"></i>
                                Información Laboral
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <p class="text-muted mb-1 small">Fecha de Ingreso</p>
                                <p class="fw-medium">@string.Format("{0:dd-MM-yyyy}", Model.fechaIngreso)</p>
                            </div>
                            <div class="mb-3">
                                <p class="text-muted mb-1 small">Cuenta IBAN</p>
                                <p class="fw-medium">@Model.cuentaIBAN</p>
                            </div>
                            <div class="mb-3">
                                <p class="text-muted mb-1 small">Salario</p>
                                <p class="fs-3 fw-bold employee-id">₡ <span id="salarioFormateado"></span> CRC</p>

                                <script>
                                    const salario = @Model.salario;

                                    // Formatear
                                    document.getElementById('salarioFormateado').textContent = formatearNumero(salario);

                                    function formatearNumero(numero) {
                                        const num = Number(numero);
                                        if (isNaN(num)) return '0';
                                        return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
                                    }
                                </script>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Directions -->
                <div class="col-lg-6">
                    <div class="card h-100 shadow-sm">
                        <div class="card-header bg-white">
                            <h5 class="card-title mb-0 card-title-custom">
                                <i class="bi bi-pin-map-fill info-icon"></i>
                                Ubicación y Direcciones
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <!-- Columna izquierda -->
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <p class="text-muted mb-1 small">Provincia</p>
                                        <p class="fw-medium">@Model.provincia</p>
                                    </div>
                                    <div class="mb-3">
                                        <p class="text-muted mb-1 small">Cantón</p>
                                        <p class="fw-medium">@Model.canton</p>
                                    </div>
                                    <div class="mb-3">
                                        <p class="text-muted mb-1 small">Distrito</p>
                                        <p class="fw-medium">@Model.distrito</p>
                                    </div>
                                </div>

                                <!-- Columna derecha -->
                                <div class="col-md-6">
                                    <div class="mb-3 flex-grow-1 min-width-0">
                                        <p class="text-muted mb-1 small">Dirección Exacta</p>
                                        <p class="fw-medium mb-0 text-break @(Model.direccionExacta == null ? "text-decoration-line-through text-danger" : "")">
                                            @(Model.direccionExacta ?? "N/A")
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Emergency -->
                <div class="col-lg-6">
                    <div class="card h-100 shadow-sm">
                        <div class="card-header bg-white">
                            <h5 class="card-title mb-0 card-title-custom">
                                <i class="bi bi-file-text info-icon"></i>
                                Contactos de Emergencia
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <p class="text-muted mb-1 small">Contacto</p>
                                <p class="fw-medium">@Model.contactoEmergencia</p>
                            </div>
                            <div class="mb-3">
                                <p class="text-muted mb-1 small">Teléfono de Emergencia</p>
                                <p class="fw-medium">+506 @Model.telefonoEmergencia</p>
                            </div>
                            <div class="mb-3">
                                <p class="text-muted mb-1 small">Tipo de Pariente</p>
                                <p class="fw-medium">@Model.tipoPariente</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }
    </main>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Incluir Lottie -->
    <script src="https://unpkg.com/@@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>

    <script>
        // Solo el código necesario para expandir la foto
        document.addEventListener('DOMContentLoaded', function() {
            // El modal de Bootstrap ya maneja la funcionalidad de expandir
            // Solo agregamos algún efecto adicional si es necesario
            const avatarModal = document.getElementById('avatarModal');
            if (avatarModal) {
                avatarModal.addEventListener('show.bs.modal', function () {
                    console.log('Modal de avatar abierto');
                });
            }
        });
    </script>
</body>
</html>


